import axios from "axios";
// import { analyzerHttpClient } from "../libs/axios";

export async function analyzeCID({ cid, userId }) {
  return axios.post(
    `https://large-field-analyzer.deanlaughing.workers.dev/upload`,
    {
      ipfsCID: cid,
      type: "cid",
    },
    {
      headers: {
        "Content-Type": "application/json",
        Authorization: `${userId}`,
      },
    }
  );
}

export async function analyzeFile(file) {
  const formData = new FormData();
  formData.append("file", file);
  // return analyzerHttpClient.post("/malware-analyzer/file", formData);
}

export async function fetchAnalyzedCIDs(userId) {
  userId = encodeURIComponent(userId);
  return fetch(
    `https://ui-query.deanlaughing.workers.dev/action/find?userId=${userId}`,
    {
      mode: "cors",
      headers: {
        "Content-Type": "application/json",
      },
    }
  ).then((res) => {
    if (res.ok) return res.json();
    throw new Error("Failed to fetch analyzed CIDs");
  });
}
